library(SCiAn)#
#
f0h4 <- paste('dataVIR/0h4-',c(1:25),'.CSV',sep='')#
f0h28 <- paste('dataVIR/0h28-',c(1:25),'.CSV',sep='')#
#
f2h4 <- paste('dataVIR/2h4-',c(1:20),'.CSV',sep='')#
f2h28 <- paste('dataVIR/2h28-',c(1:20),'.CSV',sep='')#
#
f4h4 <- paste('dataVIR/4h4-',c(1:17),'.CSV',sep='')#
f4h28 <- paste('dataVIR/4h28-',c(1:17),'.CSV',sep='')#
#
#
e0t4p1 <- meanvec(list(#
				getFLUOSTARcinetic(f0h4,findpos(rep('C:4',length(f0h4)))),#
				getFLUOSTARcinetic(f0h4,findpos(rep('D:4',length(f0h4)))),#
				getFLUOSTARcinetic(f0h4,findpos(rep('E:4',length(f0h4)))))#
)#
#
e0t4p2 <- meanvec(list(#
				getFLUOSTARcinetic(f0h4,findpos(rep('C:5',length(f0h4)))),#
				getFLUOSTARcinetic(f0h4,findpos(rep('D:5',length(f0h4)))),#
				getFLUOSTARcinetic(f0h4,findpos(rep('E:5',length(f0h4)))))#
)#
#
e0t4p3 <- meanvec(list(#
				getFLUOSTARcinetic(f0h4,findpos(rep('C:6',length(f0h4)))),#
				getFLUOSTARcinetic(f0h4,findpos(rep('D:6',length(f0h4)))),#
				getFLUOSTARcinetic(f0h4,findpos(rep('E:6',length(f0h4)))))#
)#
#
e0t4p4 <- meanvec(list(#
				getFLUOSTARcinetic(f0h4,findpos(rep('C:7',length(f0h4)))),#
				getFLUOSTARcinetic(f0h4,findpos(rep('D:7',length(f0h4)))),#
				getFLUOSTARcinetic(f0h4,findpos(rep('E:7',length(f0h4)))))#
)#
#
e0t4p5 <- meanvec(list(#
				getFLUOSTARcinetic(f0h4,findpos(rep('C:8',length(f0h4)))),#
				getFLUOSTARcinetic(f0h4,findpos(rep('D:8',length(f0h4)))),#
				getFLUOSTARcinetic(f0h4,findpos(rep('E:8',length(f0h4)))))#
)#
#
e0t4p6 <- meanvec(list(#
				getFLUOSTARcinetic(f0h4,findpos(rep('C:9',length(f0h4)))),#
				getFLUOSTARcinetic(f0h4,findpos(rep('D:9',length(f0h4)))),#
				getFLUOSTARcinetic(f0h4,findpos(rep('E:9',length(f0h4)))))#
)#
#
e0t4 <- meanvec(list(e0t4p1,e0t4p2,e0t4p3,e0t4p4,e0t4p5,e0t4p6))#
#
e0t28p1 <- meanvec(list(#
				getFLUOSTARcinetic(f0h28,findpos(rep('C:4',length(f0h28)))),#
				getFLUOSTARcinetic(f0h28,findpos(rep('D:4',length(f0h28)))),#
				getFLUOSTARcinetic(f0h28,findpos(rep('E:4',length(f0h28)))))#
)#
#
e0t28p2 <- meanvec(list(#
				getFLUOSTARcinetic(f0h28,findpos(rep('C:5',length(f0h28)))),#
				getFLUOSTARcinetic(f0h28,findpos(rep('D:5',length(f0h28)))),#
				getFLUOSTARcinetic(f0h28,findpos(rep('E:5',length(f0h28)))))#
)#
#
e0t28p3 <- meanvec(list(#
				getFLUOSTARcinetic(f0h28,findpos(rep('C:6',length(f0h28)))),#
				getFLUOSTARcinetic(f0h28,findpos(rep('D:6',length(f0h28)))),#
				getFLUOSTARcinetic(f0h28,findpos(rep('E:6',length(f0h28)))))#
)#
#
e0t28p4 <- meanvec(list(#
				getFLUOSTARcinetic(f0h28,findpos(rep('C:7',length(f0h28)))),#
				getFLUOSTARcinetic(f0h28,findpos(rep('D:7',length(f0h28)))),#
				getFLUOSTARcinetic(f0h28,findpos(rep('E:7',length(f0h28)))))#
)#
#
e0t28p5 <- meanvec(list(#
				getFLUOSTARcinetic(f0h28,findpos(rep('C:8',length(f0h28)))),#
				getFLUOSTARcinetic(f0h28,findpos(rep('D:8',length(f0h28)))),#
				getFLUOSTARcinetic(f0h28,findpos(rep('E:8',length(f0h28)))))#
)#
#
e0t28p6 <- meanvec(list(#
				getFLUOSTARcinetic(f0h28,findpos(rep('C:9',length(f0h28)))),#
				getFLUOSTARcinetic(f0h28,findpos(rep('D:9',length(f0h28)))),#
				getFLUOSTARcinetic(f0h28,findpos(rep('E:9',length(f0h28)))))#
)#
#
e0t28 <- meanvec(list(e0t28p1,e0t28p2,e0t28p3,e0t28p4,e0t28p5,e0t28p6))#
#
e2t4p1 <- meanvec(list(#
				getFLUOSTARcinetic(f2h4,findpos(rep('C:4',length(f2h4)))),#
				getFLUOSTARcinetic(f2h4,findpos(rep('D:4',length(f2h4)))),#
				getFLUOSTARcinetic(f2h4,findpos(rep('E:4',length(f2h4)))))#
)#
#
e2t4p2 <- meanvec(list(#
				getFLUOSTARcinetic(f2h4,findpos(rep('C:5',length(f2h4)))),#
				getFLUOSTARcinetic(f2h4,findpos(rep('D:5',length(f2h4)))),#
				getFLUOSTARcinetic(f2h4,findpos(rep('E:5',length(f2h4)))))#
)#
#
e2t4p3 <- meanvec(list(#
				getFLUOSTARcinetic(f2h4,findpos(rep('C:6',length(f2h4)))),#
				getFLUOSTARcinetic(f2h4,findpos(rep('D:6',length(f2h4)))),#
				getFLUOSTARcinetic(f2h4,findpos(rep('E:6',length(f2h4)))))#
)#
#
e2t4p4 <- meanvec(list(#
				getFLUOSTARcinetic(f2h4,findpos(rep('C:7',length(f2h4)))),#
				getFLUOSTARcinetic(f2h4,findpos(rep('D:7',length(f2h4)))),#
				getFLUOSTARcinetic(f2h4,findpos(rep('E:7',length(f2h4)))))#
)#
#
e2t4p5 <- meanvec(list(#
				getFLUOSTARcinetic(f2h4,findpos(rep('C:8',length(f2h4)))),#
				getFLUOSTARcinetic(f2h4,findpos(rep('D:8',length(f2h4)))),#
				getFLUOSTARcinetic(f2h4,findpos(rep('E:8',length(f2h4)))))#
)#
#
e2t4p6 <- meanvec(list(#
				getFLUOSTARcinetic(f2h4,findpos(rep('C:9',length(f2h4)))),#
				getFLUOSTARcinetic(f2h4,findpos(rep('D:9',length(f2h4)))),#
				getFLUOSTARcinetic(f2h4,findpos(rep('E:9',length(f2h4)))))#
)#
#
e2t4 <- meanvec(list(e2t4p1,e2t4p2,e2t4p3,e2t4p4,e2t4p5,e2t4p6))#
#
e2t28p1 <- meanvec(list(#
				getFLUOSTARcinetic(f2h28,findpos(rep('C:4',length(f2h28)))),#
				getFLUOSTARcinetic(f2h28,findpos(rep('D:4',length(f2h28)))),#
				getFLUOSTARcinetic(f2h28,findpos(rep('E:4',length(f2h28)))))#
)#
#
e2t28p2 <- meanvec(list(#
				getFLUOSTARcinetic(f2h28,findpos(rep('C:5',length(f2h28)))),#
				getFLUOSTARcinetic(f2h28,findpos(rep('D:5',length(f2h28)))),#
				getFLUOSTARcinetic(f2h28,findpos(rep('E:5',length(f2h28)))))#
)#
#
e2t28p3 <- meanvec(list(#
				getFLUOSTARcinetic(f2h28,findpos(rep('C:6',length(f2h28)))),#
				getFLUOSTARcinetic(f2h28,findpos(rep('D:6',length(f2h28)))),#
				getFLUOSTARcinetic(f2h28,findpos(rep('E:6',length(f2h28)))))#
)#
#
e2t28p4 <- meanvec(list(#
				getFLUOSTARcinetic(f2h28,findpos(rep('C:7',length(f2h28)))),#
				getFLUOSTARcinetic(f2h28,findpos(rep('D:7',length(f2h28)))),#
				getFLUOSTARcinetic(f2h28,findpos(rep('E:7',length(f2h28)))))#
)#
#
e2t28p5 <- meanvec(list(#
				getFLUOSTARcinetic(f2h28,findpos(rep('C:8',length(f2h28)))),#
				getFLUOSTARcinetic(f2h28,findpos(rep('D:8',length(f2h28)))),#
				getFLUOSTARcinetic(f2h28,findpos(rep('E:8',length(f2h28)))))#
)#
#
e2t28p6 <- meanvec(list(#
				getFLUOSTARcinetic(f2h28,findpos(rep('C:9',length(f2h28)))),#
				getFLUOSTARcinetic(f2h28,findpos(rep('D:9',length(f2h28)))),#
				getFLUOSTARcinetic(f2h28,findpos(rep('E:9',length(f2h28)))))#
)#
#
e2t28 <- meanvec(list(e2t28p1,e2t28p2,e2t28p3,e2t28p4,e2t28p5,e2t28p6))#
#
e4t4p1 <- meanvec(list(#
				getFLUOSTARcinetic(f4h4,findpos(rep('C:4',length(f4h4)))),#
				getFLUOSTARcinetic(f4h4,findpos(rep('D:4',length(f4h4)))),#
				getFLUOSTARcinetic(f4h4,findpos(rep('E:4',length(f4h4)))))#
)#
#
e4t4p2 <- meanvec(list(#
				getFLUOSTARcinetic(f4h4,findpos(rep('C:5',length(f4h4)))),#
				getFLUOSTARcinetic(f4h4,findpos(rep('D:5',length(f4h4)))),#
				getFLUOSTARcinetic(f4h4,findpos(rep('E:5',length(f4h4)))))#
)#
#
e4t4p3 <- meanvec(list(#
				getFLUOSTARcinetic(f4h4,findpos(rep('C:6',length(f4h4)))),#
				getFLUOSTARcinetic(f4h4,findpos(rep('D:6',length(f4h4)))),#
				getFLUOSTARcinetic(f4h4,findpos(rep('E:6',length(f4h4)))))#
)#
#
e4t4p4 <- meanvec(list(#
				getFLUOSTARcinetic(f4h4,findpos(rep('C:7',length(f4h4)))),#
				getFLUOSTARcinetic(f4h4,findpos(rep('D:7',length(f4h4)))),#
				getFLUOSTARcinetic(f4h4,findpos(rep('E:7',length(f4h4)))))#
)#
#
e4t4p5 <- meanvec(list(#
				getFLUOSTARcinetic(f4h4,findpos(rep('C:8',length(f4h4)))),#
				getFLUOSTARcinetic(f4h4,findpos(rep('D:8',length(f4h4)))),#
				getFLUOSTARcinetic(f4h4,findpos(rep('E:8',length(f4h4)))))#
)#
#
e4t4p6 <- meanvec(list(#
				getFLUOSTARcinetic(f4h4,findpos(rep('C:9',length(f4h4)))),#
				getFLUOSTARcinetic(f4h4,findpos(rep('D:9',length(f4h4)))),#
				getFLUOSTARcinetic(f4h4,findpos(rep('E:9',length(f4h4)))))#
)#
#
e4t4 <- meanvec(list(e4t4p1,e4t4p2,e4t4p3,e4t4p4,e4t4p5,e4t4p6))#
#
e4t28p1 <- meanvec(list(#
				getFLUOSTARcinetic(f4h28,findpos(rep('C:4',length(f4h28)))),#
				getFLUOSTARcinetic(f4h28,findpos(rep('D:4',length(f4h28)))),#
				getFLUOSTARcinetic(f4h28,findpos(rep('E:4',length(f4h28)))))#
)#
#
e4t28p2 <- meanvec(list(#
				getFLUOSTARcinetic(f4h28,findpos(rep('C:5',length(f4h28)))),#
				getFLUOSTARcinetic(f4h28,findpos(rep('D:5',length(f4h28)))),#
				getFLUOSTARcinetic(f4h28,findpos(rep('E:5',length(f4h28)))))#
)#
#
e4t28p3 <- meanvec(list(#
				getFLUOSTARcinetic(f4h28,findpos(rep('C:6',length(f4h28)))),#
				getFLUOSTARcinetic(f4h28,findpos(rep('D:6',length(f4h28)))),#
				getFLUOSTARcinetic(f4h28,findpos(rep('E:6',length(f4h28)))))#
)#
#
e4t28p4 <- meanvec(list(#
				getFLUOSTARcinetic(f4h28,findpos(rep('C:7',length(f4h28)))),#
				getFLUOSTARcinetic(f4h28,findpos(rep('D:7',length(f4h28)))),#
				getFLUOSTARcinetic(f4h28,findpos(rep('E:7',length(f4h28)))))#
)#
#
e4t28p5 <- meanvec(list(#
				getFLUOSTARcinetic(f4h28,findpos(rep('C:8',length(f4h28)))),#
				getFLUOSTARcinetic(f4h28,findpos(rep('D:8',length(f4h28)))),#
				getFLUOSTARcinetic(f4h28,findpos(rep('E:8',length(f4h28)))))#
)#
#
e4t28p6 <- meanvec(list(#
				getFLUOSTARcinetic(f4h28,findpos(rep('C:9',length(f4h28)))),#
				getFLUOSTARcinetic(f4h28,findpos(rep('D:9',length(f4h28)))),#
				getFLUOSTARcinetic(f4h28,findpos(rep('E:9',length(f4h28)))))#
)#
#
e4t28 <- meanvec(list(e4t28p1,e4t28p2,e4t28p3,e4t28p4,e4t28p5,e4t28p6))#
#
gr0t4 <- c(#
		givegrowth(e0t4p1),givegrowth(e0t4p2),#
		givegrowth(e0t4p3),givegrowth(e0t4p4),#
		givegrowth(e0t4p5),givegrowth(e0t4p6)#
)#
#
gr0t28 <- c(#
		givegrowth(e0t28p1),givegrowth(e0t28p2),#
		givegrowth(e0t28p3),givegrowth(e0t28p4),#
		givegrowth(e0t28p5),givegrowth(e0t28p6)#
)#
#
#
gr2t4 <- c(#
		givegrowth(e2t4p1),givegrowth(e2t4p2),#
		givegrowth(e2t4p3),givegrowth(e2t4p4),#
		givegrowth(e2t4p5),givegrowth(e2t4p6)#
)#
#
gr2t28 <- c(#
		givegrowth(e2t28p1),givegrowth(e2t28p2),#
		givegrowth(e2t28p3),givegrowth(e2t28p4),#
		givegrowth(e2t28p5),givegrowth(e2t28p6)#
)#
#
gr4t4 <- c(#
		givegrowth(e4t4p1),givegrowth(e4t4p2),#
		givegrowth(e4t4p3),givegrowth(e4t4p4),#
		givegrowth(e4t4p5),givegrowth(e4t4p6)#
)#
#
gr4t28 <- c(#
		givegrowth(e4t28p1),givegrowth(e4t28p2),#
		givegrowth(e4t28p3),givegrowth(e4t28p4),#
		givegrowth(e4t28p5),givegrowth(e4t28p6)#
)#
#
ddo0t4 <- c(#
		giveDeltaDO(e0t4p1,t.log=TRUE),giveDeltaDO(e0t4p2,t.log=TRUE),#
		giveDeltaDO(e0t4p3,t.log=TRUE),giveDeltaDO(e0t4p4,t.log=TRUE),#
		giveDeltaDO(e0t4p5,t.log=TRUE),giveDeltaDO(e0t4p6,t.log=TRUE)#
)#
#
ddo0t28 <- c(#
		giveDeltaDO(e0t28p1,t.log=TRUE),giveDeltaDO(e0t28p2,t.log=TRUE),#
		giveDeltaDO(e0t28p3,t.log=TRUE),giveDeltaDO(e0t28p4,t.log=TRUE),#
		giveDeltaDO(e0t28p5,t.log=TRUE),giveDeltaDO(e0t28p6,t.log=TRUE)#
)#
#
#
ddo2t4 <- c(#
		giveDeltaDO(e2t4p1,t.log=TRUE),giveDeltaDO(e2t4p2,t.log=TRUE),#
		giveDeltaDO(e2t4p3,t.log=TRUE),giveDeltaDO(e2t4p4,t.log=TRUE),#
		giveDeltaDO(e2t4p5,t.log=TRUE),giveDeltaDO(e2t4p6,t.log=TRUE)#
)#
#
ddo2t28 <- c(#
		giveDeltaDO(e2t28p1,t.log=TRUE),giveDeltaDO(e2t28p2,t.log=TRUE),#
		giveDeltaDO(e2t28p3,t.log=TRUE),giveDeltaDO(e2t28p4,t.log=TRUE),#
		giveDeltaDO(e2t28p5,t.log=TRUE),giveDeltaDO(e2t28p6,t.log=TRUE)#
)#
#
ddo4t4 <- c(#
		giveDeltaDO(e4t4p1,t.log=TRUE),giveDeltaDO(e4t4p2,t.log=TRUE),#
		giveDeltaDO(e4t4p3,t.log=TRUE),giveDeltaDO(e4t4p4,t.log=TRUE),#
		giveDeltaDO(e4t4p5,t.log=TRUE),giveDeltaDO(e4t4p6,t.log=TRUE)#
)#
#
ddo4t28 <- c(#
		giveDeltaDO(e4t28p1,t.log=TRUE),giveDeltaDO(e4t28p2,t.log=TRUE),#
		giveDeltaDO(e4t28p3,t.log=TRUE),giveDeltaDO(e4t28p4,t.log=TRUE),#
		giveDeltaDO(e4t28p5,t.log=TRUE),giveDeltaDO(e4t28p6,t.log=TRUE)#
)#
#
#gr4 <- list(gr0t4,gr2t4,gr4t4)#
#gr28 <- list(gr0t28,gr2t28,gr4t28)#
gr28 <- list(gr0t28,gr4t28)#
#
#ddo4 <- list(ddo0t4,ddo2t4,ddo4t4)#
#ddo28 <- list(ddo0t28,ddo2t28,ddo4t28)#
ddo28 <- list(ddo0t28,ddo4t28)#
#
library(RColorBrewer)#
#
pal <- c('black','orange')#
#
pdf(file='LivePhages.pdf')#
par(mfrow=c(1,2),pty='s',mgp=c(1.5,0.1,0),oma=c(0,0,0,0),mar=c(3,2,1,0)+0.6,bg='transparent',bty='o',tck=0.02,yaxs='r',xaxs='i')#
adv.barplot(ddo28,c('Contrôle','Phages'),xlab='',ylab='',main='Delta DO',col=pal[1:2])#
adv.barplot(gr28,c('Contrôle','Phages'),xlab='',ylab='',main='Taux de croissance',col=pal[1:2])#
dev.off()#
#
#
#lGr <- list(gr4,gr28)#
#lddo <- list(ddo4,ddo28)#
#
#mBP(lGr,condnames=c('Low temperature','High temperature'),#
#	seriesnames=c('0h','2h','4h'),ylab='Growth rate',xlab='Exposure time',#
#	legendpos='topright')#
#mBP(lddo,condnames=c('Low temperature','High temperature'),#
#	seriesnames=c('0h','2h','4h'),ylab='Malthusian',xlab='Exposure time',#
#	legendpos='topright')
pdf(file='LivePhages.pdf')#
par(mfrow=c(1,1),pty='s',mgp=c(1.5,0.1,0),oma=c(0,0,0,0),mar=c(3,2,1,0)+0.6,bg='transparent',bty='o',tck=0.02,yaxs='r',xaxs='i')#
#adv.barplot(ddo28,c('Contrôle','Phages'),xlab='',ylab='',main='Delta DO',col=pal[1:2])#
adv.barplot(gr28,c('Contrôle','Phages'),xlab='',ylab='',main='Taux de croissance',col=pal[1:2])#
dev.off()
pdf(file='LivePhages.pdf')#
par(mfrow=c(1,1),pty='s',mgp=c(1.5,0.1,0),oma=c(0,0,0,0),mar=c(3,2,1,0)+0.6,bg='transparent',bty='o',tck=0.02,yaxs='r',xaxs='i')#
adv.barplot(ddo28,c('Contrôle','Phages'),xlab='',ylab='',main='Malthusian fitness',col=pal[1:2])#
#adv.barplot(gr28,c('Contrôle','Phages'),xlab='',ylab='',main='Taux de croissance',col=pal[1:2])#
dev.off()
setwd('/Users/Tim/Programmation/BactGrParam/ANCIENS')
pdf(file='LivePhages.pdf')#
par(mfrow=c(1,1),pty='s',mgp=c(1.5,0.1,0),oma=c(0,0,0,0),mar=c(3,2,1,0)+0.6,bg='transparent',bty='o',tck=0.02,yaxs='r',xaxs='i')#
adv.barplot(ddo28,c('Control','Phages'),xlab='',ylab='',main='Malthusian fitness',col=pal[1:2])#
#adv.barplot(gr28,c('Contrôle','Phages'),xlab='',ylab='',main='Taux de croissance',col=pal[1:2])#
dev.off()#
#
#
#lGr <- list(gr4,gr28)#
#lddo <- list(ddo4,ddo28)#
#
#mBP(lGr,condnames=c('Low temperature','High temperature'),#
#	seriesnames=c('0h','2h','4h'),ylab='Growth rate',xlab='Exposure time',#
#	legendpos='topright')#
#mBP(lddo,condnames=c('Low temperature','High temperature'),#
#	seriesnames=c('0h','2h','4h'),ylab='Malthusian',xlab='Exposure time',#
#	legendpos='topright')
library(SCiAn)#
#
source('normalise.list.r')#
#
out <- analyse('TB0-24.csv','layoutTB.csv',givegrowth,bw=25)#
out2 <- analyse('TB24-48.csv','layoutTB.csv',givegrowth,bw=25)#
#
DAT <- list(#
	out$T,#
	out$Bi,#
	out$Pus,#
	out$Puv,#
	out$Bus,#
	out$BP#
)#
#
DAT2 <- list(#
	out2$T,#
	out2$Bi,#
	out2$Pus,#
	out2$Puv,#
	out2$Bus,#
	out2$BP#
)#
#
#
#
DAT <- norm.list(DAT,num=1)#
DAT2 <- norm.list(DAT2,num=1)#
#
DATN <- c('Control\n','Beads\n','Lysed\nphages','Inactivated\nphages','Sonicated\nbacteria','Phage-lysed\nbacteria')#
#
library(RColorBrewer)#
PAL <- c('black','orange')#
#
#
mBP <- function (list.of.lists, ..., condnames = 0, pal = colorRampPalette(c("grey", #
    "white")), seriesnames = 0, legendpos = "topleft", legh = TRUE, #
    do.pty = "s") #
{#
    #par(pty = do.pty, mgp = c(1.9, 0.8, 0), oma = c(1, 1, 1, #
     #   1), mar = c(4, 3, 2, 1), bg = "transparent", bty = "n", #
      #  tck = 0.02, yaxs = "i")#
        par(pty='m',yaxs='i')#
    NofList <- length(list.of.lists)#
    NofSubList <- length(list.of.lists[[1]])#
    if (condnames == 0) {#
        condnames = c(1:NofList)#
    }#
    if (seriesnames == 0) {#
        seriesnames = c(1:NofSubList)#
    }#
    dim.mat.treat <- (NofList + 1) * NofSubList#
    pos <- c(1:dim.mat.treat)#
    pos <- matrix(pos, nrow = (NofList + 1))#
    nbreaks <- dim.mat.treat + 1#
    plot(0, 0, pch = NA, xlim = c(0, nbreaks), ylim = c(min(pretty(range(list.of.lists))), #
        max(pretty(range(list.of.lists)))), xaxt = "n", yaxt = "n", #
        ...)#
    calc.ylab <- pretty(range(list.of.lists))#
    lab.ylab <- round(calc.ylab, 2)#
    abline(h = pretty(range(list.of.lists)), lty = 3, col = "darkgrey" , lwd=1.05)#
    abline(h = 0, col = 1, lwd = 1.4)#
    palette <- pal(NofList)#
    for (condition in 1:NofList) {#
        for (treatment in 1:NofSubList) {#
            CD <- list.of.lists[[condition]][[treatment]]#
            CDm <- mean(CD)#
            CDv <- sd(CD)#
            x.coord <- pos[condition, treatment]#
            rect(x.coord+0.1, 0, x.coord +0.9, CDm, col = palette[condition],border=NA)#
            arrows(x.coord + 0.5, CDm + CDv, x.coord + 0.5, CDm - #
                CDv, angle = 90, code = 3, length = 0.05)#
        }#
    }#
    axis(side = 2, at = calc.ylab, labels = lab.ylab, tick = TRUE)#
    fills <- c(1:NofList)#
    legend(legendpos, legend = condnames, fill = palette[fills], #
        bty = "n", horiz = legh, cex = 0.9)#
    cl.tab <- (c(1:NofSubList) - 1) * NofSubList + NofList/2 + #
        1#
    lab.cond <- NULL#
    int.lab.cond <- pos[c(1:(nrow(pos) - 1)), ]#
    for (COL in 1:ncol(int.lab.cond)) {#
        lab.cond[COL] <- mean(int.lab.cond[, COL]) + 0.5#
    }#
    axis(side = 1, at = lab.cond, labels = seriesnames, tick = FALSE)#
    axis(side = 4, at = pretty(range(list.of.lists)), labels = pretty(range(list.of.lists)), #
        tick = TRUE)#
    par(xaxs = "r")#
    if (min(pretty(range(list.of.lists))) < 0) {#
        abline(h = 0, lwd = 1.1)#
    }#
    abline(h = min(pretty(range(list.of.lists))), lwd = 1.1)#
}#
#
#
pdf(file='BLK-Figure1.pdf',width=10)#
#par(bg='transparent',col.axis='white',col.lab='white',fg='white',col.main='white',col.sub='white',col='white')#
mBP(#
	list(DAT,DAT2),#
	condnames=c('0 to 24 h','24 to 48 h'),#
	seriesnames=DATN,#
	do.pty='m',#
	xlab='',#
	ylab='Growth rate'#
)#
dev.off()
library(SCiAn)#
#
source('normalise.list.r')#
#
out <- analyse('TB0-24.csv','layoutTB.csv',givegrowth,bw=25)#
out2 <- analyse('TB24-48.csv','layoutTB.csv',givegrowth,bw=25)#
#
DAT <- list(#
	out$T,#
	out$Bi,#
	out$Pus,#
	out$Puv,#
	out$Bus,#
	out$BP#
)#
#
DAT2 <- list(#
	out2$T,#
	out2$Bi,#
	out2$Pus,#
	out2$Puv,#
	out2$Bus,#
	out2$BP#
)#
#
#
#
DAT <- norm.list(DAT,num=1)#
DAT2 <- norm.list(DAT2,num=1)#
#
DATN <- c('Control\n','Beads\n','Lysed\nphages','Inactivated\nphages','Sonicated\nbacteria','Phage-lysed\nbacteria')#
#
library(RColorBrewer)#
PAL <- c('black','orange')#
#
#
mBP <- function (list.of.lists, ..., condnames = 0, pal = colorRampPalette(c("grey", #
    "black")), seriesnames = 0, legendpos = "topleft", legh = TRUE, #
    do.pty = "s") #
{#
    #par(pty = do.pty, mgp = c(1.9, 0.8, 0), oma = c(1, 1, 1, #
     #   1), mar = c(4, 3, 2, 1), bg = "transparent", bty = "n", #
      #  tck = 0.02, yaxs = "i")#
        par(pty='m',yaxs='i')#
    NofList <- length(list.of.lists)#
    NofSubList <- length(list.of.lists[[1]])#
    if (condnames == 0) {#
        condnames = c(1:NofList)#
    }#
    if (seriesnames == 0) {#
        seriesnames = c(1:NofSubList)#
    }#
    dim.mat.treat <- (NofList + 1) * NofSubList#
    pos <- c(1:dim.mat.treat)#
    pos <- matrix(pos, nrow = (NofList + 1))#
    nbreaks <- dim.mat.treat + 1#
    plot(0, 0, pch = NA, xlim = c(0, nbreaks), ylim = c(min(pretty(range(list.of.lists))), #
        max(pretty(range(list.of.lists)))), xaxt = "n", yaxt = "n", #
        ...)#
    calc.ylab <- pretty(range(list.of.lists))#
    lab.ylab <- round(calc.ylab, 2)#
    abline(h = pretty(range(list.of.lists)), lty = 3, col = "darkgrey" , lwd=1.05)#
    abline(h = 0, col = 1, lwd = 1.4)#
    palette <- pal(NofList)#
    for (condition in 1:NofList) {#
        for (treatment in 1:NofSubList) {#
            CD <- list.of.lists[[condition]][[treatment]]#
            CDm <- mean(CD)#
            CDv <- sd(CD)#
            x.coord <- pos[condition, treatment]#
            rect(x.coord+0.1, 0, x.coord +0.9, CDm, col = palette[condition],border=NA)#
            arrows(x.coord + 0.5, CDm + CDv, x.coord + 0.5, CDm - #
                CDv, angle = 90, code = 3, length = 0.05)#
        }#
    }#
    axis(side = 2, at = calc.ylab, labels = lab.ylab, tick = TRUE)#
    fills <- c(1:NofList)#
    legend(legendpos, legend = condnames, fill = palette[fills], #
        bty = "n", horiz = legh, cex = 0.9)#
    cl.tab <- (c(1:NofSubList) - 1) * NofSubList + NofList/2 + #
        1#
    lab.cond <- NULL#
    int.lab.cond <- pos[c(1:(nrow(pos) - 1)), ]#
    for (COL in 1:ncol(int.lab.cond)) {#
        lab.cond[COL] <- mean(int.lab.cond[, COL]) + 0.5#
    }#
    axis(side = 1, at = lab.cond, labels = seriesnames, tick = FALSE)#
    axis(side = 4, at = pretty(range(list.of.lists)), labels = pretty(range(list.of.lists)), #
        tick = TRUE)#
    par(xaxs = "r")#
    if (min(pretty(range(list.of.lists))) < 0) {#
        abline(h = 0, lwd = 1.1)#
    }#
    abline(h = min(pretty(range(list.of.lists))), lwd = 1.1)#
}#
#
#
pdf(file='BLK-Figure1.pdf',width=10)#
#par(bg='transparent',col.axis='white',col.lab='white',fg='white',col.main='white',col.sub='white',col='white')#
mBP(#
	list(DAT,DAT2),#
	condnames=c('0 to 24 h','24 to 48 h'),#
	seriesnames=DATN,#
	do.pty='m',#
	xlab='',#
	ylab='Growth rate'#
)#
dev.off()
library(SCiAn)#
#
source('normalise.list.r')#
#
out <- analyse('TB0-24.csv','layoutTB.csv',givegrowth,bw=25)#
out2 <- analyse('TB24-48.csv','layoutTB.csv',givegrowth,bw=25)#
#
DAT <- list(#
	out$T,#
	out$Bi,#
	out$Pus,#
	out$Puv,#
	out$Bus,#
	out$BP#
)#
#
DAT2 <- list(#
	out2$T,#
	out2$Bi,#
	out2$Pus,#
	out2$Puv,#
	out2$Bus,#
	out2$BP#
)#
#
#
#
DAT <- norm.list(DAT,num=1)#
DAT2 <- norm.list(DAT2,num=1)#
#
DATN <- c('Control\n','Beads\n','Lysed\nphages','Inactivated\nphages','Sonicated\nbacteria','Phage-lysed\nbacteria')#
#
library(RColorBrewer)#
PAL <- c('black','orange')#
#
#
mBP <- function (list.of.lists, ..., condnames = 0, pal = colorRampPalette(c("grey", #
    "black")), seriesnames = 0, legendpos = "topleft", legh = TRUE, #
    do.pty = "s") #
{#
    #par(pty = do.pty, mgp = c(1.9, 0.8, 0), oma = c(1, 1, 1, #
     #   1), mar = c(4, 3, 2, 1), bg = "transparent", bty = "n", #
      #  tck = 0.02, yaxs = "i")#
        par(pty='m',yaxs='i')#
    NofList <- length(list.of.lists)#
    NofSubList <- length(list.of.lists[[1]])#
    if (condnames == 0) {#
        condnames = c(1:NofList)#
    }#
    if (seriesnames == 0) {#
        seriesnames = c(1:NofSubList)#
    }#
    dim.mat.treat <- (NofList + 1) * NofSubList#
    pos <- c(1:dim.mat.treat)#
    pos <- matrix(pos, nrow = (NofList + 1))#
    nbreaks <- dim.mat.treat + 1#
    plot(0, 0, pch = NA, xlim = c(0, nbreaks), ylim = c(min(pretty(range(list.of.lists))), #
        max(pretty(range(list.of.lists)))), xaxt = "n", yaxt = "n", #
        ...)#
    calc.ylab <- pretty(range(list.of.lists))#
    lab.ylab <- round(calc.ylab, 2)#
    abline(h = pretty(range(list.of.lists)), lty = 3, col = "darkgrey" , lwd=1.05)#
    abline(h = 0, col = 1, lwd = 1.4)#
    palette <- pal(NofList)#
    for (condition in 1:NofList) {#
        for (treatment in 1:NofSubList) {#
            CD <- list.of.lists[[condition]][[treatment]]#
            CDm <- mean(CD)#
            CDv <- sd(CD)#
            x.coord <- pos[condition, treatment]#
            rect(x.coord+0.1, 0, x.coord +0.9, CDm, col = palette[condition],border=NA)#
            arrows(x.coord + 0.5, CDm + CDv, x.coord + 0.5, CDm - #
                CDv, angle = 90, code = 3, length = 0.05)#
        }#
    }#
    axis(side = 2, at = calc.ylab, labels = lab.ylab, tick = TRUE)#
    fills <- c(1:NofList)#
    legend(legendpos, legend = condnames, fill = palette[fills], #
        bty = "n", horiz = legh, cex = 0.9)#
    cl.tab <- (c(1:NofSubList) - 1) * NofSubList + NofList/2 + #
        1#
    lab.cond <- NULL#
    int.lab.cond <- pos[c(1:(nrow(pos) - 1)), ]#
    for (COL in 1:ncol(int.lab.cond)) {#
        lab.cond[COL] <- mean(int.lab.cond[, COL]) + 0.5#
    }#
    axis(side = 1, at = lab.cond, labels = seriesnames, tick = FALSE)#
    axis(side = 4, at = pretty(range(list.of.lists)), labels = pretty(range(list.of.lists)), #
        tick = TRUE)#
    par(xaxs = "r")#
    if (min(pretty(range(list.of.lists))) < 0) {#
        abline(h = 0, lwd = 1.1)#
    }#
    abline(h = min(pretty(range(list.of.lists))), lwd = 1.1)#
}#
#
#
pdf(file='Figure1.pdf',paper='a4')#
#par(bg='transparent',col.axis='white',col.lab='white',fg='white',col.main='white',col.sub='white',col='white')#
mBP(#
	list(DAT,DAT2),#
	condnames=c('0 to 24 h','24 to 48 h'),#
	seriesnames=DATN,#
	do.pty='m',#
	xlab='',#
	ylab='Growth rate'#
)#
dev.off()
?analyse
analyse
formatDF(read.cinetic('TB0-24.csv))
''
)
'
formatDF(read.cinetic('TB0-24.csv'))
out <- analyse('TB0-24.csv','layoutTB.csv',givegrowth,bw=25)
out
mean(out$T)
names(out)
a <- NULL
a[[1]] <- 1
a[[2]] <- 2
a
boxplot(out)
setwd('/Users/Tim/These/Current experiments/Tom Bell/Part 1 - stress response/FINAL_DATA')
norm.list <- function(list,num=1,bymean=TRUE)#
{#
	N <- list#
	for(i in 1:length(list))#
	{#
		todiv <- ifelse(bymean,mean(list[[num]]),list[[num]])#
		N[[i]] <- list[[i]]/todiv#
	}#
	return(N)#
}
library(SCiAn)
T1 <- read.cinetic('tb0-24.CSV')
T2 <- read.cinetic('tb24-48.CSV')
T3 <- read.cinetic('tb48-72.CSV')
joincin(list(T1,T2,T3))
T1
formatDF(T1)
fT1 <- formatDF(T1)
fT2 <- formatDF(T2)
joincin(list(fT1,fT2))
plot(joincin(list(fT1,fT2))$B1)
plot(joincin(list(fT1,fT2))$C4)
plot(joincin(list(fT1,fT2))$C4,type='l')
fT3 <- formatDF(T3)
plot(joincin(list(fT1,fT2,fT3))$C4,type='l')
plot(joincin(list(fT1,fT2,fT3))$D6,type='l')
setwd('/Users/Tim/Desktop/SCIAN-DEVELOP/pkg/SCiAn/R')
joincin = function(list)#
{#
	out <- formatDF(list[[1]])#
	for(i in 2:length(list))#
	{#
		out <- as.data.frame(rbind(out,formatDF(list[[i]])))#
	}#
	return(out)#
}
joincin(list(T1,T2))
